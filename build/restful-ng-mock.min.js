(function(){"use strict";angular.module("restfulNgMock",[]),angular.module("restfulNgMock").factory("resourceMock",["$httpBackend",function(t){var e=function(t,e){this.code=t,this.message=e},n={collectionLabel:!1,singletonLabel:!1,httpResponseInfoLabel:!1},o=function(o,r,i){if(!/^\/[\w\-]+(\/[\w\-]+|\/\?)*$/.test(o))throw'Invalid baseUrl for resourceMock: "'+o+'".';this.baseUrl=o,this.dataSource=r,this.options=angular.extend({},n),this.setOptions(i||{});for(var a=0,s=0;o.length>s;++s)"?"===o.charAt(s)&&++a;var c=o.replace("/","\\/","g").replace("?","([\\w\\-]+)"),u=RegExp("^"+c+"(?:/([\\w\\-]+))?$"),l=this,p=function(t){angular.isUndefined(t)&&(t=new e(404,"Not Found"));var n={code:200,message:"OK"};return t instanceof e&&(n.code=t.code,n.message=t.message,t=l.options.httpResponseInfoLabel?{}:n),l.options.httpResponseInfoLabel&&(t[l.options.httpResponseInfoLabel]=n),[n.code,JSON.stringify(t),{"Content-Type":"application/json"}]},f=function(t,n,o,r){for(var i=purl(t),s=u.exec(i.attr("path")).slice(1),c=[],f=0;s.length>f;++f)"null"!=typeof s[f]&&s[f]!==void 0&&c.push(s[f]);var h,g;if(r.atRoot&&c.length===a)return h=r.atRoot.call(l,c,i,n,o),h&&l.options.collectionLabel&&(g=h,h={},h[l.options.collectionLabel]=g),p(h);if(r.atItem&&c.length>a){var d=c.slice(0,-1),v=c[c.length-1];return h=r.atItem.call(l,d,v,i,n,o),h&&l.options.singletonLabel&&(g=h,h={},h[l.options.singletonLabel]=g),p(h)}return p(new e(400,"Bad Request"))};t.whenGET(RegExp(u)).respond(function(t,e,n,o){return f(e,n,o,{atRoot:l.indexAction,atItem:l.showAction})}),t.whenPOST(RegExp(u)).respond(function(t,e,n,o){return f(e,n,o,{atRoot:l.createAction})}),t.whenPUT(RegExp(u)).respond(function(t,e,n,o){return f(e,n,o,{atItem:l.updateAction})}),t.whenDELETE(RegExp(u)).respond(function(t,e,n,o){return f(e,n,o,{atItem:l.deleteAction})})};o.prototype={subResourceMock:function(t,e){return new o(this.baseUrl+"/?"+t,e)},getStorage:function(t,e){e=e||!1;for(var n=this.dataSource,o=0;t.length>o;++o)if(n[t[o]])n=n[t[o]];else{if(!e)return null;n[t[o]]={},n=n[t[o]]}return n||null},setOptions:function(t){var e=this;angular.forEach(t,function(t,o){if(n[o]===void 0)throw"Invalid option key "+o;e.options[o]=t})},indexAction:function(t){var e=this.getStorage(t);if(e){var n=[];for(var o in e)e.hasOwnProperty(o)&&n.push(e[o]);return n}},showAction:function(t,e){var n=this.getStorage(t);return n&&n[e]?n[e]:void 0},createAction:function(t,e,n){var o=JSON.parse(n);return o.id=""+Math.round(Math.random()*Math.pow(2,32)),this.getStorage(t,!0)[o.id]=o,o},updateAction:function(t,e,n,o){var r=this.getStorage(t);if(r&&r[e]){var i=JSON.parse(o);return i.id=e,r[e]=i,i}},deleteAction:function(t,e){var n=this.getStorage(t);if(n&&n[e]){var o=n[e];return delete n[e],o}}};var r=function(t,e){return new o(t,e)};return r}])})(window);