(function(){"use strict";angular.module("restfulNgMock",[]),angular.module("restfulNgMock").factory("basicMock",["$httpBackend",function(t){function e(t,e){if(this._baseUrl=t||"",!o.test(this._baseUrl))throw'Invalid baseUrl for resourceMock: "'+t+'".';this.options=angular.extend({},this.DEFAULT_OPTIONS),this.setOptions(e||{})}var o=/^(\/[\w\-]+|)(\/[\w\-]+|\/\?)*$/;e.prototype.constructor=e,e.prototype.HttpError=function(){function t(t,e){this.code=t,this.message=e}return t}(),e.prototype.HttpRequest=function(){function t(t,e,o,n,r,i){this.pathArgs=t,this.method=e,this.rawUrl=o,this.url=n,this.rawBody=r,this.body=/^application\/json($|;)/.test(i["Content-Type"])?JSON.parse(r):r,this.headers=i}return t}(),e.prototype.RouteOptions=function(){function t(){this.filters=[]}return t.prototype.addFilter=function(t){this.filters.push(t)},t}(),e.prototype.DEFAULT_OPTIONS={debug:!1,httpResponseInfoLabel:!1},e.prototype._buildResponse=function(t,e){(angular.isUndefined(t)||null===t)&&(t=new this.HttpError(404,"Not Found"));var o={code:200,message:"OK"};t instanceof this.HttpError&&(o.code=t.code,o.message=t.message,t=this.options.httpResponseInfoLabel?{}:o),this.options.httpResponseInfoLabel&&(t[this.options.httpResponseInfoLabel]=o);var n=JSON.stringify(t);if(this.options.debug){var r=this.options.debug;"function"!=typeof r&&(r=this._defaultDebug),r(e,o,JSON.parse(n))}return[o.code,n,{"Content-Type":"application/json"}]},e.prototype._defaultDebug=function(t,e,o){var n=function(t,e){return Array(Math.max(e-(t+"").length+1,0)).join(0)+t},r=new Date,i=[n(r.getHours(),2),n(r.getMinutes(),2),n(r.getSeconds(),2),n(r.getMilliseconds(),3)];console.log([i.join(":"),">>> "+t.method+" "+t.rawUrl,"<<< "+e.code,o])},e.prototype.route=function(e,n,r){if(!o.test(n))throw'Invalid url for route: "'+n+'".';var i=this._baseUrl+n,s=i.replace(/\//g,"\\/").replace(/\?/g,"([\\w\\-]+)"),a=RegExp("^"+s+"(?:\\?.*)?$"),u=new this.RouteOptions,p=this;return t.when(e,a).respond(function(t,e,o,n){var i=purl(e,!0),s=a.exec(i.attr("path")).slice(1),c=new p.HttpRequest(s,t,e,i,o,n),l=r.call(p,c);return angular.forEach(u.filters,function(t){t.call(this,l,c)}),p._buildResponse(l,c)}),u},e.prototype.setOptions=function(t){var e=this;return angular.forEach(t,function(t,o){if(e.DEFAULT_OPTIONS[o]===void 0)throw"Invalid option key "+o;e.options[o]=t}),e};var n=function(t,o){return new e(t,o)};return n.classFn=e,n}]),angular.module("restfulNgMock").factory("resourceMock",["basicMock",function(t){function e(t,o,n){e._super.constructor.call(this,t,n),this.dataSource=o||{},this.requiredParams=0;for(var r=0;t.length>r;++r)"?"===t.charAt(r)&&++this.requiredParams;this.route("GET","",function(t){var e=this.indexAction(t);return this._labelEncap(!0,e)}),this.route("GET","/?",function(t){var e=this.showAction(t);return this._labelEncap(!1,e)}),this.route("POST","",function(t){var e=this.createAction(t);return this._labelEncap(!1,e)}),this.route("PUT","/?",function(t){var e=this.updateAction(t);return this._labelEncap(!1,e)}),this.route("DELETE","/?",function(t){var e=this.deleteAction(t);return this._labelEncap(!1,e)})}(function(){function o(){this.constructor=e}var n=t.classFn;o.prototype=n.prototype,e.prototype=new o,e._super=n.prototype})(),e.prototype.parent=e.prototype,e.prototype.DEFAULT_OPTIONS=angular.extend({},e._super.DEFAULT_OPTIONS,{collectionLabel:!1,singletonLabel:!1,skipArgumentName:!1,limitArgumentName:!1}),e.prototype._labelEncap=function(t,e){if(e&&!(e instanceof this.HttpError)){var o=null;if(t&&this.options.collectionLabel?o=this.options.collectionLabel:!t&&this.options.singletonLabel&&(o=this.options.singletonLabel),o){var n=e;e={},e[o]=n}}return e},e.prototype.subResourceMock=function(t,o,n){return new e(this._baseUrl+"/?"+t,o,n)},e.prototype.getStorage=function(t,e){e=e||!1;for(var o=this.dataSource,n=0;t.length>n;++n)if(o[t[n]])o=o[t[n]];else{if(!e)return null;o[t[n]]={},o=o[t[n]]}return o||null},e.prototype.indexAction=function(t){var e=this.getStorage(t.pathArgs);if(e){var o=[];if(angular.forEach(e,function(t,e){/^\d+$/.test(e)&&(e=parseInt(e,10)),o.push(e)}),o.sort(),this.options.skipArgumentName){var n=parseInt(t.url.param(this.options.skipArgumentName),10);n&&(o=o.slice(n))}if(this.options.limitArgumentName){var r=parseInt(t.url.param(this.options.limitArgumentName),10);r&&(o=o.slice(0,r))}var i=[];return angular.forEach(o,function(t){i.push(e[t])}),i}},e.prototype.showAction=function(t){return this.getStorage(t.pathArgs)},e.prototype.createAction=function(t){var e=t.body;return e.id=Math.round(Math.random()*Math.pow(2,32)),this.getStorage(t.pathArgs,!0)[e.id]=e,e},e.prototype.updateAction=function(t){var e=t.body,o=this.getStorage(t.pathArgs.slice(0,-1)),n=t.pathArgs[t.pathArgs.length-1];return o&&o[n]?(e.id=o[n].id,o[n]=e,e):void 0},e.prototype.deleteAction=function(t){var e=this.getStorage(t.pathArgs.slice(0,-1)),o=t.pathArgs[t.pathArgs.length-1];if(e&&e[o]){var n=e[o];return delete e[o],n}};var o=function(t,o){return new e(t,o)};return o.classFn=e,o}])})(window);